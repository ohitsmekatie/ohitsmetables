{% extends "base.html" %}

{% block content %}
  <div class="text-center">
    <h1 class="mb-4 display-5">
      <i class="fas fa-drumstick-bite me-2"></i> Food Generator
    </h1>

    <!-- Options -->
    <div class="row justify-content-center mb-3">
      <div class="col-md-4">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="includeWeird">
          <label class="form-check-label" for="includeWeird">Weird Side Effect</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="includeMagical">
          <label class="form-check-label" for="includeMagical">Magical Side Effect</label>
        </div>
      </div>
    </div>

    <!-- Generate button -->
    <div class="row justify-content-center mb-4">
      <div class="col-md-4 text-center">
        <button id="generateEncounterBtn">
          <i class="fas fa-wand-sparkles me-2"></i> Generate Food
        </button>
      </div>
    </div>

    <!-- Result display -->
    <div id="foodDisplay" class="encounter-card text-center d-none mt-4"></div>
  </div>
{% endblock %}

{% block scripts %}
{{ super() }}

<script>
  document.getElementById("generateEncounterBtn").addEventListener("click", async () => {
    const includeWeird = document.getElementById("includeWeird").checked;
    const includeMagical = document.getElementById("includeMagical").checked;

    try {
      const response = await fetch(`/food-item?weird=${includeWeird}&magical=${includeMagical}`);
      if (!response.ok) throw new Error(await response.text());

      const data = await response.json();
      const display = document.getElementById("foodDisplay");

      display.innerHTML = `
        <h5 class="fw-bold mb-3">${data.food_item}</h5>
        <p class="mb-3">${data.description}</p>
        ${data.weird ? `<hr><p class="fw-bold mb-1">ðŸŒ€ Weird Side Effect</p><p class="mb-3">${data.weird}</p>` : ""}
        ${data.magical ? `<hr><p class="fw-bold mb-1">âœ¨ Magical Side Effect</p><p class="mb-3">${data.magical}</p>` : ""}
      `;

      display.classList.remove("d-none");
      display.classList.add("show");
    } catch (err) {
      console.error("Error fetching food item:", err);
    }
  });
</script>
{% endblock %}

